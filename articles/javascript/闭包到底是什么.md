åœ¨å¼„æ¸…é—­åŒ…æ˜¯ä»€ä¹ˆä¹‹å‰ï¼Œå¿…é¡»å…ˆäº†è§£JSçš„ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾ã€‚é“¾æ¥ï¼š[æ·±å…¥ç†è§£JavaScriptä½œç”¨åŸŸ](articles/javascript/æ·±å…¥ç†è§£JavaScriptä½œç”¨åŸŸ.md)
### é—­åŒ…çš„å®šä¹‰
æ ¹æ®ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹é‡Œçš„åŸè¯
> é—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡çš„å‡½æ•°

æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™å¥è¯ï¼š1ã€é—­åŒ…æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ 2ã€è¿™ä¸ªå‡½æ•°æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°çš„å˜é‡

ä¸¾ä¸ªğŸŒ°
```javascript
function foo () {
  var a = 1
  function bar() {
    console.log(a)
  }
}
```
æ ¹æ®å®šä¹‰ï¼Œä¸Šè¿°ä»£ç ä¸­å‡½æ•°barå°±æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚

### é—­åŒ…çš„ä½¿ç”¨
é‚£ä¹ˆé—­åŒ…å¸®æˆ‘ä»¬è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ

æ¯”å¦‚æˆ‘ä»¬æƒ³è®¡ç®—ç”¨æˆ·åœ¨æŸä¸ªé¡µé¢å‘†äº†å¤šé•¿æ—¶é—´

ä¸€èˆ¬å†™æ³•ï¼š
```javascript
var initTime = new Date();

window.onbeforeunload = function(event) {
  sendToService(new Date() - initTime)
};
```
ä¸Šé¢å°†initTimeå®šä¹‰ä¸ºå…¨å±€å˜é‡ã€‚ä½†æ˜¯å…¨å±€å˜é‡è¿‡å¤šä¼šéš¾ä»¥ç»´æŠ¤ã€‚ä½¿ç”¨é—­åŒ…æ”¹å†™ä¸€ä¸‹ï¼š
```javascript
getStayTime () {
  var initTime = new Date()

  return function () {
    sendToService(new Date() - initTime)
  }
}

var sendTime = getStayTime(); // åˆå§‹åŒ–äº†æ—¶é—´ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªå‡½æ•°

window.onbeforeunload = function(event) {
  sendTime()
};
```

è¿™æ ·å°±è§£å†³äº†å…¨å±€å˜é‡æ»¥ç”¨çš„é—®é¢˜ï¼Œä½†æ˜¯åˆå¤šå‡ºæ¥ä¸€ä¸ªsendTimeå˜é‡äº†ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ

æˆ‘ä»¬ç»“åˆè‡ªæ‰§è¡Œå‡½æ•°å†æ”¹è¿›ä¸€ä¸‹ï¼š
```javascript
(function () {
  var initTime = new Date()
  function getStayTime () {
    sendToService(new Date() - initTime)
  }
  window.onbeforeunload = function(event) {
    getStayTime()
  }
})()
```

è¿™æ ·ï¼Œè®¡ç®—ç”¨æˆ·åœ¨æ­¤é¡µé¢å‘†äº†å¤šé•¿æ—¶é—´çš„ä»£ç å°±é›†ä¸­åˆ°äº†ä¸€èµ·ã€‚æ¸…æ™°ä¸”ä¾¿äºç»´æŠ¤ï¼Œä¹Ÿä¸æ±¡æŸ“å…¨å±€ç¯å¢ƒ

### é—­åŒ…çš„æ»¥ç”¨ä¼šé€ æˆå†…å­˜æº¢å‡º
